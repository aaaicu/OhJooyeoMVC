<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="worship">
	<select id="getWorshipId" parameterType = "string" resultType="string">
		<![CDATA[
			SELECT worship_id
			FROM WORSHIP
			WHERE worship_date = #{date}
		]]>		
	</select>
	<select id="getWorshipMap" parameterType = "string" resultType="map">
		<![CDATA[
			SELECT worship_id worshipId, worship_date worshipDate, main_presenter mainPresenter, next_presenter nextPresenter, next_prayer nextPrayer, next_offer nextOffer
			FROM WORSHIP
			WHERE worship_id = #{worshipId}
		]]>		
	</select>
	<select id="getVersionById" parameterType = "string" resultType="string">
		<![CDATA[
			SELECT version
			FROM WORSHIP
			WHERE worship_id = #{id}
		]]>		
	</select>
	
	<select id = "getWorshipList" resultType ="map" >
		<![CDATA[
			SELECT worship_id AS worshipId, DATE_FORMAT(worship_date, '%Y-%m-%d') AS worshipDate
			FROM WORSHIP
		]]>
	</select>
	
	<select id="getWorshipDateById" parameterType = "string" resultType="string">
		<![CDATA[
			SELECT worship_date
			FROM WORSHIP
			WHERE worship_id = #{id}
		]]>		
	</select>
	<select id ="getWorshipIdList" parameterType = "string" resultType="string">
		<![CDATA[
			SELECT worship_id
			FROM WORSHIP
			WHERE user_id = #{userId}	
			ORDER BY worship_id desc
		]]>	
	</select>
	
	<insert id ="insertWorship" parameterType = "kr.co.ohjooyeo.vo.WorshipVO">
		<![CDATA[
		INSERT INTO WORSHIP VALUES ( 
			#{worshipId},
			#{worshipDate},
			#{mainPresenter},
			#{nextPresenter},
			#{nextPrayer},
			#{nextOffer},
			#{version},
			#{userId}			
		)
		]]>
	</insert>
	
	<update id = "setVersion" parameterType = "map">
		<![CDATA[
			UPDATE ohjooyeo.WORSHIP SET version = #{version} WHERE worship_id = #{worshipId}
		]]>
	</update>
</mapper>